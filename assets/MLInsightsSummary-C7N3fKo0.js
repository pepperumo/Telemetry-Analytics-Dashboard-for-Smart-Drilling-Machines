import{j as o,V as b,U as e}from"./index-DkNXKMsf.js";const E=({className:m="",onDrillDown:i})=>{const[t,u]=o.useState(null),[y,f]=o.useState(!0),[_,v]=o.useState(null),[p,j]=o.useState(new Date);o.useEffect(()=>{x();const r=setInterval(x,3e4);return()=>clearInterval(r)},[]);const x=async()=>{try{v(null);const[r,n]=await Promise.all([b.getHealthScores(),b.getAlerts({status:"active",per_page:100})]),a=r.health_scores,c=n.alerts,s=a.reduce((h,L)=>h+L.health_score,0),l=a.length>0?s/a.length:0,g=a.filter(h=>h.health_score<70).length,d=N(a,c),A=w(a),k=M(c),C={overall_health_score:Math.round(l),devices_at_risk:g,active_alerts:c.length,maintenance_efficiency:d,cost_savings_potential:A,next_critical_action:k};u(C),j(new Date)}catch(r){v(r instanceof Error?r.message:"Failed to load ML summary"),console.error("Failed to load ML summary metrics:",r)}finally{f(!1)}},N=(r,n)=>{const a=r.filter(d=>d.health_score>=80).length,c=r.length,s=n.filter(d=>d.severity==="critical").length;if(c===0)return 0;const l=a/c,g=Math.min(s*.1,.3);return Math.round(Math.max(0,l-g)*100)},w=r=>{const n=r.reduce((a,c)=>{const s=Math.max(0,85-c.health_score);return a+s},0);return Math.round(n*100)},M=r=>{const n=r.filter(s=>s.severity==="critical"||s.severity==="high").sort((s,l)=>s.predicted_failure_time&&l.predicted_failure_time?new Date(s.predicted_failure_time).getTime()-new Date(l.predicted_failure_time).getTime():s.predicted_failure_time?-1:l.predicted_failure_time?1:0);if(n.length===0)return null;const a=n[0],c=a.predicted_failure_time?Math.ceil((new Date(a.predicted_failure_time).getTime()-Date.now())/(1e3*60*60*24)):7;return{device_id:a.device_id,action:a.title,days_remaining:Math.max(0,c)}},S=r=>r>=80?"text-green-600":r>=60?"text-yellow-600":r>=40?"text-orange-600":"text-red-600",$=r=>r>=80?"bg-green-50 border-green-200":r>=60?"bg-yellow-50 border-yellow-200":r>=40?"bg-orange-50 border-orange-200":"bg-red-50 border-red-200";return y?e.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 border border-gray-200 ${m}`,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"🤖 ML System Overview"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[...Array(6)].map((r,n)=>e.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded mb-2"}),e.jsx("div",{className:"h-8 bg-gray-300 rounded"})]},n))})]}):_?e.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 border border-gray-200 ${m}`,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"🤖 ML System Overview"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-red-600 mb-2",children:"⚠️ Failed to load ML insights"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:_}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Retry"})]})]}):t?e.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 border border-gray-200 ${m}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"🤖 ML System Overview"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Updated: ",p.toLocaleTimeString()]}),e.jsx("button",{onClick:x,className:"text-sm px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:"🔄"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer hover:shadow-md transition-shadow ${$(t.overall_health_score)}`,onClick:()=>i&&i("health-scores"),children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Overall Health"}),e.jsxs("div",{className:`text-2xl font-bold ${S(t.overall_health_score)}`,children:[t.overall_health_score,"%"]}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:t.overall_health_score>=80?"Excellent":t.overall_health_score>=60?"Good":t.overall_health_score>=40?"Fair":"Poor"})]}),e.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer hover:shadow-md transition-shadow ${t.devices_at_risk===0?"bg-green-50 border-green-200":t.devices_at_risk<=2?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200"}`,onClick:()=>i&&i("health-scores"),children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Devices at Risk"}),e.jsx("div",{className:`text-2xl font-bold ${t.devices_at_risk===0?"text-green-600":t.devices_at_risk<=2?"text-yellow-600":"text-red-600"}`,children:t.devices_at_risk}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Health < 70%"})]}),e.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer hover:shadow-md transition-shadow ${t.active_alerts===0?"bg-green-50 border-green-200":t.active_alerts<=3?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200"}`,onClick:()=>i&&i("maintenance"),children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Active Alerts"}),e.jsx("div",{className:`text-2xl font-bold ${t.active_alerts===0?"text-green-600":t.active_alerts<=3?"text-yellow-600":"text-red-600"}`,children:t.active_alerts}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Require attention"})]}),e.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer hover:shadow-md transition-shadow ${t.maintenance_efficiency>=80?"bg-green-50 border-green-200":t.maintenance_efficiency>=60?"bg-yellow-50 border-yellow-200":"bg-orange-50 border-orange-200"}`,onClick:()=>i&&i("maintenance"),children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Maintenance Efficiency"}),e.jsxs("div",{className:`text-2xl font-bold ${t.maintenance_efficiency>=80?"text-green-600":t.maintenance_efficiency>=60?"text-yellow-600":"text-orange-600"}`,children:[t.maintenance_efficiency,"%"]}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Proactive ratio"})]}),e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border-2 border-blue-200 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>i&&i("patterns"),children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Cost Savings"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["$",t.cost_savings_potential.toLocaleString()]}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Annual potential"})]}),e.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer hover:shadow-md transition-shadow ${t.next_critical_action?t.next_critical_action.days_remaining<=1?"bg-red-50 border-red-200":t.next_critical_action.days_remaining<=3?"bg-orange-50 border-orange-200":"bg-yellow-50 border-yellow-200":"bg-green-50 border-green-200"}`,onClick:()=>i&&i("maintenance"),children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Next Critical Action"}),t.next_critical_action?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`text-lg font-bold ${t.next_critical_action.days_remaining<=1?"text-red-600":t.next_critical_action.days_remaining<=3?"text-orange-600":"text-yellow-600"}`,children:t.next_critical_action.days_remaining===0?"Today":t.next_critical_action.days_remaining===1?"Tomorrow":`${t.next_critical_action.days_remaining} days`}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",title:t.next_critical_action.action,children:t.next_critical_action.device_id})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:"All Clear"}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"No urgent actions"})]})]})]}),t.next_critical_action&&e.jsx("div",{className:`p-4 rounded-lg border-l-4 ${t.next_critical_action.days_remaining<=1?"bg-red-50 border-red-400":t.next_critical_action.days_remaining<=3?"bg-orange-50 border-orange-400":"bg-yellow-50 border-yellow-400"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"🚨 Priority Action Required"}),e.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[e.jsxs("strong",{children:[t.next_critical_action.device_id,":"]})," ",t.next_critical_action.action]}),e.jsx("p",{className:"text-xs text-gray-600",children:t.next_critical_action.days_remaining===0?"Action required today to prevent equipment failure":`${t.next_critical_action.days_remaining} days remaining before predicted failure`})]}),e.jsx("div",{className:`px-3 py-1 rounded text-sm font-medium ${t.next_critical_action.days_remaining<=1?"bg-red-100 text-red-800":t.next_critical_action.days_remaining<=3?"bg-orange-100 text-orange-800":"bg-yellow-100 text-yellow-800"}`,children:t.next_critical_action.days_remaining<=1?"URGENT":t.next_critical_action.days_remaining<=3?"HIGH":"MEDIUM"})]})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t.overall_health_score>=80&&t.active_alerts===0?"bg-green-400":t.overall_health_score>=60&&t.active_alerts<=3?"bg-yellow-400":"bg-red-400"}`}),e.jsxs("span",{className:"text-gray-600",children:["ML System Status: ",t.overall_health_score>=80&&t.active_alerts===0?"Optimal":t.overall_health_score>=60&&t.active_alerts<=3?"Monitoring":"Attention Required"]})]}),e.jsx("span",{className:"text-gray-500",children:"Auto-refresh: 30s"})]})})]}):e.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 border border-gray-200 ${m}`,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"🤖 ML System Overview"}),e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No ML data available"})]})};export{E as default};
